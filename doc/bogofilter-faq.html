<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><title>Bogofilter FAQ</title></head>
<body>
<h1>Bogofilter FAQ</h1>
<p>
Official Version:
<a href="http://bogofilter.sourceforge.net/bogofilter-faq.html">
http://bogofilter.sourceforge.net/bogofilter-faq.html</a><br>
Maintainer: David Relson &lt;relson&lt;at&gt;osagesoftware&lt;dot&gt;com&gt;
</p>
<p>
This document is intended to answer frequently asked questions about 
bogofilter. 
</p>
<p>
<ul>
  <li><a href="#what_is_bogofilter">What is bogofilter?</a></li>
  <li><a href="#history">Bogofilter History</a></li>
  <li><a href="#home_page">Bogofilter Home Page</a></li>
  <li><a href="#lists">Bogofilter Mailing Lists</a></li>
  <li><a href="#token_counts">How do I find the spam and ham counts for a token?</a></li>
  <li><a href="#message_count">How do I tell how many messages are in my wordlists?</a></li>
  <li><a href="#wordlist_size">How do I tell how many tokens are in my wordlists?</a></li>
  <li><a href="#port_notes">How do I get Bogofilter working on Solaris, BSD, etc.?</a></li>
  <li><a href="#nfs">Can I share wordlists over NFS?</a></li>
  <li><a href="#rescue">How can I tell if my wordlists are corrupted?</a></li>
  <li><a href="#return_codes">Why does bogofilter give return codes like 0 and 256
         when it's run from inside a program?</a></li>
  <li><a href="#changed_options">Now that I've upgraded to 0.11 why are my scripts broken?</a></li>
  <li>How can I use SpamAssassin to train Bogofilter? (coming soon)</li>
</ul>

<hr>

<p><a name="what_is_bogofilter"></a><b>What is bogofilter?</b></p>
<p>
Bogofilter is a fast Bayesian spam filter along the lines suggested 
by Paul Graham in his article <a href="http://www.paulgraham.com/spam.html">
A Plan For Spam</a>.
<a href="http://radio.weblogs.com/0101454/stories/2002/09/16/spamDetection.html">
Gary Robinson</a>'s geometric-mean algorithm is also included as is his modification
of the algorithm to use Fisher's method.
<p>
Check the <a href="http://bogofilter.sourceforge.net">
bogofilter home page</a> for more information.
</p>

<hr>

<p><a name="history"></a><b>Bogofilter History</b></p>
<p>
Bogofilter was written by Eric S. Raymond on August 19, 2002. It gained
popularity in September 2002, and a number of other authors have started
to contribute to the project.
</p>

<hr>

<p><a name="home_page"></a><b>Bogofilter Home Page</b></p>
<p>
The <a href="http://bogofilter.sourceforge.net">bogofilter home page</a> at
sourceforge is the central clearinghouse for bogofilter resources.
</p>

<hr>

<p><a name="lists"></a><b>Mailing Lists</b></p>
<p>
There are currently four mailing lists for bogofilter
</p>

<table border="1" width="100%">
<tr>
<td><b>List Address</b></td>
<td><b>Links</b></td>
<td><b>Description</b></td>
</tr>

<tr>
<td>bogofilter-announce@aotto.com</td>
<td><a href=
"mailto:bogofilter-announce-subscribe@aotto.com">[subscribe]</a><a
href=
"http://news.gmane.org/thread.php?group=gmane.mail.bogofilter.announce">
[archive]</a></td>
<td>An announcement-only list where new versions are
announced.</td>
</tr>

<tr>
<td>bogofilter@aotto.com</td>
<td><a href=
"mailto:bogofilter-subscribe@aotto.com">[subscribe]</a><a href=
"http://news.gmane.org/thread.php?group=gmane.mail.bogofilter.general">
[archive]</a></td>
<td>A discussion list where any conversation about bogofilter may
take place.</td>
</tr>

<tr>
<td>bogofilter-dev@aotto.com</td>
<td><a href=
"mailto:bogofilter-dev-subscribe@aotto.com">[subscribe]</a><a href=
"http://news.gmane.org/thread.php?group=gmane.mail.bogofilter.devel">
[archive]</a></td>
<td>A list for sharing patches, development, and technical
discussions.</td>
</tr>

<tr>
<td>bogofilter-cvs@lists.sourceforge.net</td>
<td><a href=
"http://lists.sourceforge.net/mailman/listinfo/bogofilter-cvs">[subscribe]</a><a
 href=
"http://sourceforge.net/mailarchive/forum.php?forum=bogofilter-cvs">
[archive]</a></td>
<td>Mailing list for announcing code changes to the CVS
archive.</td>
</tr>
</table>

<hr>

<p><a name="token_counts"></a><b>How do I find the spam and ham counts for a token?</b></p>
<p>
 Use bogoutil's '-w' option to display info about a token (word).
 For example, "bogoutil -d $BOGOFILTER_DIR example.com" gives the good and 
 bad counts for "example.com".
 </p>

<hr>

<p><a name="message_count"></a><b>How do I tell how many messages are in my wordlists?</b></p>
<p>
 Use bogoutil's '-w' option to display the value of special token .MSG_COUNT, 
 i.e. run command "bogoutil -w $BOGOFILTER_DIR .MSG_COUNT" to see the counts 
 for the spam and ham wordlists.
 </p>

<hr>

<p><a name="wordlist_size"></a><b>How do I tell how many tokens are in my wordlists?</b></p>
<p>
 Pipe the output of bogoutil's dump command to command "wc", 
 i.e. use "bogoutil -d $BOGOFILTER_DIR/spamlist.db | wc -l " to display the 
 count for the spamlist and use "bogoutil -d $BOGOFILTER_DIR/goodlist.db | wc -l"
  to display the count for the goodlist.
 </p>

<hr>

<p><a name="port_notes"></a><b>How do I get bogofilter working on Solaris, BSD, etc?</b></p>
<p>
If you don't already have a v3.0+ version of 
<a href="http://www.sleepycat.com">BerkeleyDB</a>, then
<a href="http://www.sleepycat.com/download.html">
download it</a> unpack it, and do these commands in the 'dist' directory:
</p>
<p>
<pre>
$ ./configure
$ make
$ make install
</pre>
<p>
Next, download a <a href="http://sourceforge.net/project/showfiles.php?group_id=62265">
portable version</a> of bogofilter.
</p>
<p>
<b>On Solaris</b>
</p>
<p>
Unpack it, and then do:
</p>
<pre>
$ ./configure --with-db=/usr/local/BerkeleyDB-4.0
$ make &amp;&amp; make install
</pre>
<p>
You will either want to put a symlink to libdb.so in /usr/lib, or use a modified 
LD_LIBRARY_PATH environment variable before you start bogofilter.
</p>
<p>
<pre>
$ LD_LIBRARY_PATH=/usr/lib:/usr/local/lib:/usr/local/BerkeleyDB-4.0
</pre>
<p>
<b>On FreeBSD</b>
</p>
<p>
Unpack it, and do:
</p>
<p>
<pre>
$ ./configure --with-db=/usr/local/BerkeleyDB.4.0
$ make &amp;&amp; make install
$ ldconfig /usr/lib /usr/local/lib \
/usr/local/BerkeleyDB.4.0/lib
</pre>
<p>
The 'ldconfig' command gives the runtime linker a way to find the new 
libraries. Be careful not to clobber other paths you may have added using
ldconfig.
</p>
<p>
<b>On HP-UX</b>
</p>
<p>
See the file README.hp-ux in the source distribution.

<hr>

<p><a name="nfs"></a><b>Can I share wordlists over NFS?</b></p>
<p>
Yes, provided you use the correct file locking to avoid data corruption.
When you compile bogofilter, you will need to verify that the configure
script has set "#define HAVE_FCNTL 1" in your config.h file. Popular UNIX
operating systems will all support this. If you are running an unusual, or
an older version of an operating system, make sure it supports fcntl().
If "#define HAVE_FCNTL 1" is set, then comment out "#define HAVE_FLOCK 1" 
so that the locking system uses fcntl() locking instead of the default of 
flock() locking. If your system does not support fcntl, then you will not
be able to share wordlist files over NFS without the risk of data corruption.
</p>
<p>
Next, make sure you have NFS set up properly, with "lockd" running. Refer
to your NFS documentation for more information about running "lockd" or
"rpc.lockd". Most operating systems with NFS turn this on by default.
</p>

<hr>
<p><a name="rescue"><b>How can I tell if my wordlists are corrupted?</b></a></p>
<p>If you think your wordlists are hosed, you can see what BerkeleyDB thinks by running:
<p><pre>
db_verify spamlist.db
db_verify goodlist.db
</pre><p>

If there is a problem, you may be able to recover some (or all) of the tokens and their counts with the following commands:
<p>
<pre>bogoutil -d spamlist.db | bogoutil -l spamlist.db.new</pre>
<p>
or with
<p><pre>
db_dump -r spamlist.db &gt; spamlist.txt
db_load spamlist.new &lt; spamlist.txt
</pre></p>


<hr>
<p><a name="return_codes"></a><b>Why does bogofilter give return codes
like 0 and 256 when it's run from inside a program?</b></p>
<p>
 Likely the return codes are being reformatted by waitpid(2).  
 Use WEXITSTATUS(status) in sys/wait.h, or comparable macro, to get the correct value.
 </p>

<hr>
<p><a name="changed_options"><b>Now that I've upgraded to 0.11 why are
	my scripts broken?</b></a></p>
<p>With version 0.11 bogofilter's options for registering mail as ham or
spam have been changed.  They now allow registering (or unregistering)
messages in the ham and spam wordlists.  Prior to this, there was no way
to unregister a message from a wordlist (without registering it in the
other wordlist).</p>

<p>Bogofilter has four registration options - '-s', '-n', '-S', and
'-N'.  With the release of version 0.11 the meaning of '-S' and '-N' has
been changed to allow unregistering messages from the word lists.
Here's what the four options mean:</p>

<ul>
  <li>'-s' means to register the current message as spam,
      i.e. add its tokens to spamlist.db</li>
  <li>'-n' means to register the current message as ham,
      i.e. add its tokens to goodlist.db</li>
  <li>'-S' means to unregister the current message from the spam wordlist,
      i.e. remove its tokens from spamlist.db</li>
  <li>'-N' means to unregister the current message from the ham wordlist,
      i.e. remove its tokens from goodlist.db</li>
</ul>

<p>Prior to version 0.11, the '-S' option was used to move a message
from the ham wordlist to the spam wordlist, i.e. there were two actions.
Now with 0.11 each of the two actions is invoked by its own option.  To
get the same effect as the old '-S', you should use '-N -s' (or '-Ns'
which means the same thing).</p>

<p>Similarly, the old '-N' option is now '-Sn' (or '-S -n').</p>

<p>MUA recipes typically use '-s' and '-n' and don't need to change.
Other scripts which use '-S' and '-N' for fixing registration errors
<b>do</b> need to be changed.</p>

<hr><pre>
$Id$
</pre>
</body>
</html>
