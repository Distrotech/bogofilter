#! /bin/sh

# Note:  When run via "make check", test output files are automatically deleted.
#	 When run from the command line, outputs files are left in directory
#	 bogoutil-hist.YYYYMMDD.  This is useful when something is different.
#
#	 ./inputs  - test inputs
#	 ./outputs - known correct outputs
#
#	 bogoutil-hist.YYYYMMDD:
#		tests   - directory containing individual output files

NODB=1 . ${srcdir=.}/t.frame

[ -d ${TMPDIR}/tests ] && rm -rf ${TMPDIR}/tests
mkdir -p ${TMPDIR}/tests

OPTS="-C -y 0"

$BOGOFILTER $OPTS -r -s < ${SYSTEST}/inputs/spam.mbx
$BOGOFILTER $OPTS -r -n < ${SYSTEST}/inputs/good.mbx

OUT="bogoutil-hist.out"

$BOGOUTIL -H $BOGOFILTER_DIR >${TMPDIR}/$OUT

if  [ $verbose -eq 0 ]; then
    cmp ${OUTPUTS}/$OUT ${TMPDIR}/$OUT
else
    diff $DIFF_BRIEF ${OUTPUTS}/$OUT ${TMPDIR}/$OUT
fi

