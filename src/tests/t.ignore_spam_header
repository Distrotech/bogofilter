#! /bin/sh

. ${srcdir=.}/t.frame

# t.ignore_spam_header
#
# 	bogofilter should remove all copies of the spam 
#	header line in the incoming message, i.e. 
#	the output file should exactly 1 copy of it.

shn=`./spam_header_name`

cat > $TMPDIR/input <<EOF
From somewhere@example.com Fri Nov 22 11:30:23 2002
$shn: blah1
$shn: blah2
      ... folded continuation 1
      ... folded continuation 2
$shn: blah3

Friend,

EOF

# check seekable input
$VAL ${relpath}/bogofilter -p -e -C < $TMPDIR/input > $TMPDIR/output1
# check non-seekable input
cat $TMPDIR/input | $VAL ${relpath}/bogofilter -p -e -C >$TMPDIR/output2

count=`grep $shn $TMPDIR/output1 | wc -l`
test $count = "1"
count=`grep $shn $TMPDIR/output2 | wc -l`
test $count = "1"
